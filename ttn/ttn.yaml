# Home Assistant Package
# ttn
# Bridge:
# - mqtt to mqtt
# - v3 to home/v3

### ### ###

mqtt:
#2
  sensor:  
########### Misc ##########
###4
    - name: "LoRa C3 Counter"
      unique_id: EBx_LoRa_C3_Counter
      state_topic: "home/v3/nikito-app@ttn/devices/eui-70b3d57ed0061977/up"
      value_template: >
        {% if value_json.uplink_message is defined %}
          {{ value_json.uplink_message.f_cnt }}
        {% endif %}
      state_class: measurement
###4
    - name: "LoRa C3 MB Err"
      unique_id: EBx_LoRa_C3_MB_Err
      state_topic: "home/v3/nikito-app@ttn/devices/eui-70b3d57ed0061977/up"
      value_template: >
        {% if value_json.uplink_message is defined %}
          {% if value_json.uplink_message.decoded_payload is defined %}
            {% if value_json.uplink_message.decoded_payload.ERR is defined %}
              {% set x = value_json.uplink_message.decoded_payload.ERR|int(0) %}
              {% if x > -1 %}
                {{ x }}
              {% endif %}
            {% endif %}
          {% endif %}
        {% endif %}
      state_class: measurement
###4
    - name: "LoRa 32 Counter"
      unique_id: EBx_LoRa_32_Counter
      state_topic: "home/v3/nikito-app@ttn/devices/eui-70b3d57ed0061c7b/up"
      value_template: >
        {% if value_json.uplink_message is defined %}
          {{ value_json.uplink_message.f_cnt }}
        {% endif %}
      state_class: measurement
###4
# EOF

